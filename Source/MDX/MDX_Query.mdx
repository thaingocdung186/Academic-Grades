--CAU1
SELECT {[Measures].[FACT Count]} ON COLUMNS,
{[DIM SCORE].[ispass].&[1]} ON ROWS
FROM [STUDENTSCORE]
--CAU2
SELECT [Measures].[Fact Count] ON COLUMNS,
TOPCOUNT(
    {[DIM STUDENT].[CITY].CHILDREN},
    4,
    ([DIM STUDENT].[Region].[Norte], [DIM SCORE].[ISPASS])
    ) ON ROWS
FROM [STUDENTSCORE]
--CAU3
SELECT [Measures].[FACT Count] ON COLUMNS,
FILTER (
	[DIM STUDENT].[CITY].[FARO],
	[DIM SCORE].[FINALGRADE].[B+]
	) ON ROWS
FROM [STUDENTSCORE]
WHERE [DIM SCORE].[FINALGRADE].[B+]
--CAU4
SELECT 
NON EMPTY {[DIM SCHOOL].[SCHOOL].CHILDREN} ON COLUMNS,
NON EMPTY {[DIM SCHOOLCHOICE].[REASON].[REASON].MEMBERS} ON ROWS
FROM [STUDENTSCORE]
WHERE ([MEASURES].[FACT COUNT], [DIM SCORE].[ISPASS].[1])
--CAU5
SELECT 
	NON EMPTY [Measures].[FACT Count] ON COLUMNS,
	NON EMPTY [DIM STUDENT].[CITY].MEMBERS ON ROWS
FROM (
    SELECT (
        GENERATE(
            DrillDownLevel([DIM STUDENT].[STATE].&[AZORES]),
            ORDER(
                FILTER(
                    [DIM STUDENT].[CITY].CHILDREN,
                    [Measures].[FACT Count] >= 30
                ),
                [Measures].[FACT Count], ASC
            )
        )
    ) ON 0
    FROM [STUDENTSCORE]
)
--CAU6
WITH 
MEMBER [Measures].[SUM Fact Count] AS
    SUM(
		[Measures].[FACT Count]
    )
SELECT 
  NON EMPTY [Measures].[SUM Fact Count] ON COLUMNS,
  NON EMPTY 
  DrillUpLevel(
      FILTER(
          [DIM STUDENT].[REGION - STATE - CITY].[STATE].&[AZORES],
          [Measures].[FACT Count] >= 30
      ), 
      [DIM STUDENT].[REGION - STATE - CITY].[CITY]
  ) ON ROWS
FROM [STUDENTSCORE]
--CAU7
SELECT
	NON EMPTY 
	{[DIM STUDENT].[FJOB].[TEACHER],
	[DIM STUDENT].[FJOB].[SERVICES]} ON ROWS,
	NON EMPTY {[MEASURES].[FACT COUNT]} ON COLUMNS
FROM [STUDENTSCORE]
WHERE [DIM STUDENT].[CITY].[VILA NOVA DE GAIA]
--CAU8
SELECT 
    NON EMPTY [DIM STUDENT].[CITY].CHILDREN 
	HAVING[MEASURES].[FACT COUNT] > 20 ON ROWS,
    {[MEASURES].[FACT COUNT]} ON COLUMNS
FROM [STUDENTSCORE]
WHERE [DIM ACTIVITY].[ROMANTIC].&[1]
--CAU9
SELECT 
  [DIM STUDENT].[SEX].CHILDREN ON COLUMNS,
  [DIM STUDENT].[REGION].CHILDREN ON ROWS
FROM [STUDENTSCORE]
--CAU10
SELECT
    [DIM STUDENT].[CITY].[CITY].MEMBERS ON ROWS,
    [Measures].[FACT COUNT] ON COLUMNS
FROM [STUDENTSCORE]
WHERE (
    FILTER(
        [DIM STUDENT].[REGION].[REGION].MEMBERS,
        [Measures].[FACT COUNT] > 120
    )
)


















